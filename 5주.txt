기계학습 5주차

모델 평가 방법과 오버피팅

교차 검증
테스트 케이스에 대해 여러가지 경우의 수가 나올 수 있는데( 즉 여러가지의 선으로 구분 지을수 있다)
이것을 정확도를 따져 더 좋은 선을 찾는 것을 의미한다. 전체 데이터에서 일부를 테스트 데이터로 나머지를 트레이닝 데이터로 사용을 한다.

 학습 데이터도 여러가지로 나눠 각각을 파라미터로 해서 케이스를 여러개 만들고 테스트 케이스를 이용해 검증을 해본다.

홀드아웃 방법
하나만 통채로 트레이닝 하는 것이다

k-겹 교차 검증
k개로 나눠 각각의 케이스로 만들어 테스트케이스로 정확성을 구함

리브 p 아웃 교차검증
p개의 셈플 데이터를 선택하여 그것으로 모델 검증 나머지는 트레이닝?
리브 원 아웃 교차검증
한개의 셈플 데이터로 검증
-> 이게 한번만 하는 것이 아니라 각각 하나씩 번갈아가면 셈플 데이터가 되고 나머지를 트레이닝 시키는 방식으로 사용되어 오래 걸린다.

정확도
정확도  구하는 법
전체의 데이터를 다 더하고(1000개) 실제 음성인데 음성으로 예측한것과 양성인데 양성예측한것을 더하여(880) 880/1000해주면 된다.

정확도가 높다고 항상 좋은 모델은 아니다.(ppt)에 예시가 있다. 음성 900명 양성 100명일 때 모두 음성이라고 판명햇다면 0.9이지만 좋은 결과는 아니다(양성이 없다)
->그래서  정확도 뿐만 아니라 Precision, Recall과 이것들을 이용한 F1 Score등을 주로 사용한다.

Precision
예측이 참인데 실제와 맞으면 True Positive 실제와 다르면 False Positive
예측이 거짓인데 실제도 거짓일 경우 True Negative 실제가 참이면 FalseNegative
그래서 이것들을 각각 TP FP TN FN이라 부른다.
Percision 은 TP/(TP+FP) 이다.

Recall 의 경우
TP/(TP+FN)

sklearn모듈에 accuracy_score라는 정확도를 구하는 모델이 존재한다.

confusion_matrix 
각 클래스의 정확도를 나타낸다. 강의자료 참고

X_train,X_test, y_trian, y_test = train_test_split(X,y,test_size=0.3)
0.3크기만큼을 테스트 케이스로 나눈다. 즉 모델을 나누는 것이다.

sc = StandardScaler()
sc.fit(x_train) 방대한 양의 데이터들을 0~1사이 값으로 변환하는것이다. 

fit은 새로운 모델을 만드는 것이고
predict은 내가 x값을 넣었을때 그 모델로 나온 값은 뭘까 라는 뜻
===============================

@과적합
모델을 너무 세부적으로 하려고 구분이 너무 과하게 이루어진 것을 말한다. 

np.ployfit(x,y,degree) degree부분이 방정식의 차수
n차형 모델을 만들기 위함이다. 이건 강의자료의 예제를 봐야 될 거 같음.
------------------------------------------------------

@Logistic Regression
리뉴어 리그레션(선형회귀방정식) 과 비슷한 거지만 선형이 아닌 것으로 분류하는 것이다.

선형은 방정식을 찾았지면 로지스틱은 분류할수 있는 구분점을 찾는 것에 쓰인다.

선형회귀모델은 연속성이 있어서 값을 예측할 때 자주 쓰인다.

예상보다 큰값이 나오면 기준이 계속 변화하여 오차가 생길 수 있다.

시그모이드 함수
모델이 주어졌을 때 해당 데이터를 맞출 확률
선형회귀 데이터의 분포를 데이터가 구분되는 시점을 분리내서 데이터가 무엇인지 분류.

시그모이드로 변환을 하면 이 값은 0또는 1에 가까운 분류값이 된다.(근데 이거는 케이스가 두개일 때를 생각하고 잇다)

선형회귀의 경우  MSE 즉 로스를 최소화시키는 방향

분류의 경우는
둘을 가로 질러야하는데..
이것을 구분하기 위해서 Cross Entropy Loss라는 것을 사용한다.

Cross Entropy Loss
로지스틱 모델의 예측분포는 시그모이드 이고 y가 0일때 앞쪽 term을 계산, 1일때 뒤쪽 Term을 계산한다.




------------------------------------------------------

@Keras 이용한 순차 모델


Linear Regression vs Logistic Regression
연속                        분류
이전까진 sklearn 패키지를 사용햇엇다

TensorFlow (2.x버전을 사용)
머신러닝과 딥러닝을 위한 라이브러리
구글에서 만듬

Keras : sklearn처럼 잘 정의 되어있는 것이다. 신경망 학습에 이 패키지를 많이 사용한다. 근데 이것이 tensorflow와 관련이 있다.









